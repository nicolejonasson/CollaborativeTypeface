<!doctype html>
<!-- See http://www.firepad.io/docs/ for detailed embedding docs. -->
<html>

<head>
  <meta charset="utf-8" />

  <!-- p5js -->
  <meta name="viewport" width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0>

  <link rel="stylesheet" href="styles.css" type="text/css">
  <script src="../p5.min.js"></script>
  <script src="../addons/p5.dom.min.js"></script>
  <script src="../addons/p5.sound.min.js"></script>
  <script src="sketch.js"></script>

  <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
  <script src="../js/jquery-min.js"></script>
  <script src="../js/jquery-ui.js"></script>
  <script src="../js/jquery.js"></script>



  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/5.0.2/firebase.js"></script>

  <!-- CodeMirror -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.css" />

  <!-- Firepad -->
  <link rel="stylesheet" href="styles.css" type="text/css">
  <script src="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.min.js"></script>


</head>

<body onload="init()">
  <div id= "head-bar">
  <div>the library the library the library the library the library the library the library the library the library the library the library the library</div>
</div>

    <a href = "../home/index.html" >
      <div id= "exit"> go back to common room go back to common room go back to common room go back to common room</div>
    </a>

    <div id = "canvasContainer"> </div>
    <!-- <div id= "head">
      <div class ="box" id="head-1">wellcome</div>
      <div class ="box" id="head-2">to the</div>
      <div onclick = "show('head-4')" class ="box" id="head-3">playground</div>

        <div onclick = "show('head-5')" class ="box" id="head-4">you can draw</div>
        <div onclick = "show('head-6')" class ="box" id="head-5"> and play</div>

          <div onclick = "show('head-7')" class ="box" id="head-6">continue drawing</div>
          <div onclick = "show('head-8')"class ="box" id="head-7">share open source things</div>

    </div> -->

    <div class = "head">
        <div  class = "intro-box" id = "head-0">welcome</div>
        <div  class = "intro-box" id = "head-1">you are at</div>
        <div onclick = "showHide('head-3')" class = "intro-box" id = "head-2" >the library <i class="arrow right"></i> </div>
        <div onclick = "showBox('head-4')" class = "box-head" id = "head-3">a place for reading </div>
        <div onclick = "showBox('head-5')" class = "box-head" id = "head-4">and writing</div>
        <div onclick = "showBox('head-6')" class = "box-head" id = "head-5"> search for new text</div>
        <div onclick = "showBox('head-7')" class = "box-head" id = "head-6"> or share your own finds </div>
        <div onclick = "showBox('head-8')" class = "box-head" id = "head-7"> ask questions  </div>
        <div onclick = "showBox('head-8')" class = "box-head" id = "head-8"> and start conversations </div>

  </div>



    <div id="bookmarks-wrapper">
      <div id = "bookmark" > bookmarks </div>

      <div class= "ex-box">The bookmarks are a collection of links. Share texts, books, webpages, or whatever you find interesting.
        Write a small description of the topic and link, if you feel like it. <br>
</div>
      <div class= "ex-box">If you want to start a new topic for an empty bookmark, give it a name in the boxes to the left.<br>
      </div>


    </div>
    <div class="drag" id = "explanation"> find the bookmark in the list or write your own headline for a bookmark</div>


      <div class="drag" id="draggable-0" >Ã¸</div>




  <!-- <button onclick ="updateList()"> submit </button>
 -->


  <div class = "links">
      <div onmousemove ="updateList()" id = "heading"> subject </div>
      <li onclick ="firepadStyles('firepad-0')">o
        <input onblur="submitText('input-0')" type = "text" id = "input-0">
      </li>
      <li onclick ="firepadStyles('firepad-1')">o
        <input onblur="submitText('input-1')" type = "text" id = "input-1">
      </li>
      <li onclick ="firepadStyles('firepad-2')">o
        <input onblur="submitText('input-2')" type = "text" id = "input-2">
      </li>
      <li onclick ="firepadStyles('firepad-3')">o
        <input  onblur="submitText('input-3')" type = "text" id = "input-3">
      </li>
      <li onclick ="firepadStyles('firepad-4')">o
        <input  onblur="submitText('input-4')" type = "text" id = "input-4">
      </li>
      <li onclick ="firepadStyles('firepad-5')">o
        <input  onblur="submitText('input-5')" type = "text" id = "input-5">
      </li>
      <li onclick ="firepadStyles('firepad-6')">o
        <input  onblur="submitText('input-6')" type = "text" id = "input-6">
      </li>
      <li onclick ="firepadStyles('firepad-7')">o
        <input onblur="submitText('input-7')" type = "text" id = "input-7">
      </li>
      <li onclick ="firepadStyles('firepad-8')">o
          <input onblur="submitText('input-8')" type = "text" id = "input-8">
      </li>
      <li onclick ="firepadStyles('firepad-9')">o
        <input onblur="submitText('input-9')" type = "text" id = "input-9">
      </li>
      <li onclick ="firepadStyles('firepad-10')">o
        <input onblur="submitText('input-10')" type = "text" id = "input-10">
      </li>
      <li onclick ="firepadStyles('firepad-11')">o
        <input onblur="submitText('input-11')" type = "text" id = "input-11">
      </li>
      <li onclick ="firepadStyles('firepad-12')">o
        <input onblur="submitText('input-12')" type = "text" id = "input-12">
      </li>
      <li onclick ="firepadStyles('firepad-13')">o
        <input onblur="submitText('input-13')" type = "text" id = "input-13">
      </li>
      <li onclick ="firepadStyles('firepad-14')">o
        <input onblur="submitText('input-14')" type = "text" id = "input-14">
      </li>
      <li onclick ="firepadStyles('firepad-15')">o
        <input onblur="submitText('input-15')" type = "text" id = "input-15">
      </li>
      <li onclick ="firepadStyles('firepad-16')">o

        <input onblur="submitText('input-16')" type = "text" id = "input-16">
      </li>
      <li onclick ="firepadStyles('firepad-17')">o

        <input onblur="submitText('input-17')" type = "text" id = "input-17">
      </li>
      <li onclick ="firepadStyles('firepad-18')">o

        <input onblur="submitText('input-18')" type = "text" id = "input-18">
      </li>
      <li onclick ="firepadStyles('firepad-19')">o

        <input onblur="submitText('input-19')" type = "text" id = "input-19">
      </li>
      <li onclick ="firepadStyles('firepad-20')">o

        <input onblur="submitText('input-20')" type = "text" id = "input-20">
      </li>
      <li onclick ="firepadStyles('firepad-21')">o

        <input onblur="submitText('input-21')" type = "text" id = "input-21">
      </li>
      <li onclick ="firepadStyles('firepad-22')">o

        <input onblur="submitText('input-22')" type = "text" id = "input-22">
      </li>

  </div>

  <div class = firepad-wrapper>
    <div onclick ="firepadStyles('firepad-0')" class =" box" id="firepad-0">  </div>
    <div onclick ="firepadStyles('firepad-1')" class =" box" id="firepad-1">  </div>
    <div onclick ="firepadStyles('firepad-2')" class =" box" id="firepad-2">  </div>
    <div onclick ="firepadStyles('firepad-3')" class =" box" id="firepad-3">  </div>
    <div onclick ="firepadStyles('firepad-4')" class =" box" id="firepad-4">  </div>
    <div onclick ="firepadStyles('firepad-5')" class =" box" id="firepad-5">  </div>
    <div onclick ="firepadStyles('firepad-6')" class =" box" id="firepad-6">  </div>
    <div onclick ="firepadStyles('firepad-7')" class =" box" id="firepad-7">  </div>
    <div onclick ="firepadStyles('firepad-8')" class =" box" id="firepad-8">  </div>
    <div onclick ="firepadStyles('firepad-9')" class =" box" id="firepad-9">  </div>
    <div onclick ="firepadStyles('firepad-10')" class =" box" id="firepad-10">  </div>
    <div onclick ="firepadStyles('firepad-11')" class =" box" id="firepad-11">  </div>
    <div onclick ="firepadStyles('firepad-12')" class =" box" id="firepad-12">  </div>
    <div onclick ="firepadStyles('firepad-13')" class =" box" id="firepad-13">  </div>
    <div onclick ="firepadStyles('firepad-14')" class =" box" id="firepad-14">  </div>
    <div onclick ="firepadStyles('firepad-15')" class =" box" id="firepad-15"> </div>
    <div onclick ="firepadStyles('firepad-16')" class =" box" id="firepad-16">  </div>
    <div onclick ="firepadStyles('firepad-17')" class =" box" id="firepad-17">  </div>
    <div onclick ="firepadStyles('firepad-18')" class =" box" id="firepad-18">  </div>
    <div onclick ="firepadStyles('firepad-19')" class =" box" id="firepad-19">  </div>
    <div onclick ="firepadStyles('firepad-20')" class =" box" id="firepad-20">  </div>
    <div onclick ="firepadStyles('firepad-21')" class =" box" id="firepad-21">  </div>
    <div onclick ="firepadStyles('firepad-22')" class =" box" id="firepad-22">  </div>

    <!-- <div class =" box"  id="image"> <img src="1.jpg"> </div> -->
  </div>

  <div id= "bookClub" > book club </div>
  <div class= "ex-box" id="ex-bookClub">Start discussions or share thoughts on nothing. <br> Ask questions or answer them. </div>

  <div class= "container">
    <div class= "bottom" id= "toolbar-1"> </div>
    <div class= "bottom" id= "toolbar-2"> </div>
    <div class= "bottom" id= "toolbar-3"> </div>
    <div class= "bottom" id= "toolbar-4"> </div>

    <div class= "greyBox" id= "question">ask a question
      <input type = "text" id="input-qestion">

      <!-- <input onblur="submitText('input-qestion')" type = "text" id="input-qestion"> -->
      <button onclick ="updateName('input-qestion')" id ="question-button">ask</button>
    </div>

  </div>

  <div id= "question-container">
    <div class= "drag" id= "question-0"></div>
    <div class= "drag" id= "question-1"></div>
    <div class= "drag" id= "question-2"></div>
    <div class= "drag" id= "question-3"></div>
    <div class= "drag" id= "question-4"></div>
    <div class= "drag" id= "question-5"></div>
    <div class= "drag" id= "question-6"></div>
    <div class= "drag" id= "question-7"></div>
    <div class= "drag" id= "question-8"></div>
    <div class= "drag" id= "question-9"></div>
    <div class= "drag" id= "question-10"></div>
    <div class= "drag" id= "question-11"></div>
    <div class= "drag" id= "question-12"></div>
  </div>






  <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src='https://code.jquery.com/ui/1.12.1/jquery-ui.min.js'></script>

  <script>

    function init() {

      // // Initialize Firebase.
      // // TODO: replace with your Firebase project configuration.
      var config = {
        apiKey: "AIzaSyDTLvn12YhyZ86R_zHw2AauWa8swoJwRZc",
        authDomain: "collab-6fa95.firebaseapp.com",
        databaseURL: "https://collab-6fa95.firebaseio.com",
        projectId: "collab-6fa95",
        storageBucket: "collab-6fa95.appspot.com",
        messagingSenderId: "942968685131"

      };
      firebase.initializeApp(config);

      // the firepad with toolbar
      // for (var i = 0; i < 2; i++){
        var firepadRef = firebase.database().ref("new1");

        var codeMirror = CodeMirror(document.getElementById("toolbar-1"), { lineWrapping: true });

        var firepad = Firepad.fromCodeMirror(firepadRef, codeMirror, {
          richTextShortcuts: true,
          richTextToolbar: true,
        });


        var firepadRef = firebase.database().ref("new2");

        var codeMirror = CodeMirror(document.getElementById("toolbar-2"), { lineWrapping: true });

        var firepad = Firepad.fromCodeMirror(firepadRef, codeMirror, {
          richTextShortcuts: true,
          richTextToolbar: true,
        });



        var firepadRef = firebase.database().ref("new3");

        var codeMirror = CodeMirror(document.getElementById("toolbar-3"), { lineWrapping: true });

        var firepad = Firepad.fromCodeMirror(firepadRef, codeMirror, {
          richTextShortcuts: true,
          richTextToolbar: true,
        });

        var firepadRef = firebase.database().ref("new4");

        var codeMirror = CodeMirror(document.getElementById("toolbar-4"), { lineWrapping: true });

        var firepad = Firepad.fromCodeMirror(firepadRef, codeMirror, {
          richTextShortcuts: true,
          richTextToolbar: true,
        });




      for (var i = 0; i < 23; i++) {

        var firepadRef = firebase.database().ref("library"+i);

        var codeMirror = CodeMirror(document.getElementById("firepad-"+i), { lineWrapping: true });

        var firepad = Firepad.fromCodeMirror(firepadRef, codeMirror, {
          richTextShortcuts: true,
          richTextToolbar: false,
        });
      }



        var ref = firebase.database().ref("input-qestion");
        ref.limitToLast(12).once("value", gotData, errData);


          function gotData(data){

                  var text = data.val();
                  var keys = Object.keys(text);


                  for(var i= 0; i < keys.length; i++){
                    var k = keys[i];

                    var head = text[k].heading;

                    console.log(head);

                    var para = document.createElement("P");
                    var textnode = document.createTextNode(head);
                    para.appendChild(textnode);
                    console.log(textnode);
                    document.getElementById("question-" + i).appendChild(para);

                  }
                }

                function errData(err){
                  console.log("ERROR!");
                  console.log(err);
                }



  }



function updateName(name){
  var text = document.getElementById(name).value;


      var ref = firebase.database().ref(name);

      var data = {
          heading: text
        }

      ref.push(data);

  // var x = document.getElementById("toolbar-5");
  var ref = firebase.database().ref("input-qestion");
  ref.limitToLast(1).once("value", gotData, errData);


    function gotData(data){

            var text = data.val();
            var keys = Object.keys(text);


            for(var i= 0; i < keys.length; i++){
              var k = keys[i];

              var head = text[k].heading;

              console.log(head);



              //create an element
              var $element = $('<div class="drag"/>').text(head);

              //append it to the DOM
              $("#question-container").append($element);

              //make it "draggable" and "resizable"
              $element.draggable();

              return false;
            }
          }




        function errData(err){
          console.log("ERROR!");
          console.log(err);
        }

}



function updateList(){
  var x = [];
  var head;
  console.log(head);
  var elems = document.querySelectorAll('input');

    for (var i = 0; i < elems.length; i++){
      console.log("in here");
      var x = elems[i];
      var ref = firebase.database().ref("input-" + i);

        ref.limitToLast(1).on("value", gotData, errData);
    }


    function gotData(data){

            var text = data.val();
            var keys = Object.keys(text);
            console.log(keys);

            for(var i= 0; i < keys.length; i++){
              var k = keys[i];
              console.log(k);
              var head = text[k].heading;
              x.defaultValue = head;
              // x.style.background = "grey";
            }
          }

        function errData(err){
          console.log("ERROR!");
          console.log(err);
        }

}





function submitText(name){

  var text = document.getElementById(name).value;
  console.log(text);


      var ref = firebase.database().ref(name);

      var data = {
          heading: text
        }

      ref.push(data);
      console.log(data);
}




  function firepadStyles(name){
    clear = document.querySelectorAll(".firepad-richtext");
    console.log(clear);
    // clear = document.getElementsByClassName("firepad-richtext");
    for (var i = 0; i < clear.length; i++) {
      var x = clear[i];
      x.style.background = "rgb(255, 255, 255 ,0.5)";
      // x.style.background = "rgb(249, 246, 239,0.5)";
      x.style.zIndex = "0";
      x.style.width ="250px"
      x.style.padding ="0px";
      }

    elems = document.getElementById(name).querySelectorAll(".firepad-richtext");
    for (var i = 0; i < elems.length; i++) {
      var x = elems[i];
      // x.style.transition = "all 2s";
      x.style.background = "grey";
      x.style.zIndex = "2";
      x.style.width ="400px";
      }
    }

    function showHide(name){
      var x = document.getElementById(name);
      var elems = document.getElementsByClassName("box-head");

      if (x.style.visibility == 'visible'){
        // x.style.visibility = 'hidden';

        for (var i = 0; i < elems.length; i++) {
          var y = elems[i];
          if (y.style.visibility == 'visible'){
            y.style.visibility = 'hidden';
          }
        }

      }
      else{
        x.style.visibility = 'visible';
      }
    }



    function showBox(name){
      var x = document.getElementById(name);
        if (x.style.visibility == 'visible'){
          x.style.visibility = 'hidden';

        }
        else{

          x.style.visibility = 'visible';
        }

      }

      $(function() {
          $( ".drag" ).draggable();
      });



  </script>
</body>
